<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3>Students</h3>
    <button class="btn btn-primary" (click)="openAddStudent()">Add Student</button>
  </div>

  <div *ngIf="loading">Loading…</div>

  <div *ngIf="!loading && students.length === 0" class="text-muted">No students yet</div>

  <div *ngFor="let s of students" class="card p-3 mb-2">
    <div class="d-flex justify-content-between align-items-center">
      <div>
        <strong>{{ s.fullName }}</strong> — {{ s.email }}
        <div class="small text-muted">Phone: {{ s.phoneNumber }}</div>
      </div>

      <div class="d-flex gap-2 align-items-center">
        <select class="form-control form-control-sm" [(ngModel)]="selectedGuide[s._id]">
          <option [ngValue]="null">-- Select Guide --</option>
          <option *ngFor="let g of guides" [ngValue]="g._id">{{ g.fullName }}</option>
        </select>
        <button class="btn btn-sm btn-success" (click)="assignGuide(s._id)" [disabled]="!selectedGuide[s._id]">Assign</button>
      </div>
    </div>
  </div>
</div>

<!-- Add Student Modal - similar to admin add user -->
<div class="modal-backdrop" *ngIf="showAddStudent">
  <div class="modal-card">
    <h4>Add Student</h4>
    <form #addStudentForm="ngForm" (ngSubmit)="submitAddStudent(addStudentForm)" novalidate>
      <div class="form-group"><label>Full name</label><input ngModel name="fullName" required class="form-control"></div>
      <div class="form-group"><label>Email</label><input ngModel name="email" type="email" required class="form-control"></div>
      <div class="form-group"><label>Phone</label><input ngModel name="phoneNumber" class="form-control"></div>
      <div class="form-group"><label>Address</label><input ngModel name="address" class="form-control"></div>
      <div class="form-group"><label>City</label><input ngModel name="city" class="form-control"></div>
      <div class="form-group"><label>State</label><input ngModel name="state" class="form-control"></div>
      <div class="form-group"><label>Password</label><input ngModel name="password" type="password" required class="form-control"></div>
      <div class="mt-3 d-flex justify-content-end gap-2">
        <button type="button" class="btn btn-secondary" (click)="closeAddStudent()">Cancel</button>
        <button [disabled]="addingStudent" type="submit" class="btn btn-primary">
          <span *ngIf="!addingStudent">Add Student</span>
          <span *ngIf="addingStudent">Adding…</span>
        </button>
      </div>
    </form>
  </div>
</div>
